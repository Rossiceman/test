 <!DOCTYPE html>
 <html lang="en">
 <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>測驗</title>
    <link rel="stylesheet" href="css/all.min.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/mycolor.css">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"
    />
 </head>
 <body>
    <!--**********s01**********-->
 <section id="s01" class="bg-secondary">
    <div class="container text-end">
      <a href="#">
        <i class="fa-brands fa-square-facebook text-white"></i>
      </a>
      <a href="#">
        <i class="fa-brands fa-square-x-twitter text-white"></i>
      </a>
    </div>
  </section>
  <!--**********s02**********-->
  <section id="s02" class="bg-white">
    <nav class="navbar navbar-expand-lg bg-body-tertiary">
      <div class="container-fluid">
        <a class="navbar-brand" href="#"
          >Test</a
        >
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav me-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a
                class="nav-link active"
                aria-current="page"
                href="#"
                >首頁</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#"></a>
            </li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="true"
              >
               
              </a>
              <ul class="dropdown-menu">
                <li>
                  <a
                    class="dropdown-item disabled"
                    id="s02_btn01"
                    href="#"
                    target="_blank"
                    ></a
                  >
                </li>
                <li>
                  <a
                    class="dropdown-item disabled"
                    id="s02_btn02"
                    ref="#"
                    ></a
                  >
                </li>
                <li>
                  <a class="dropdown-item disabled" id="s02_btn03" href="#"
                    ></a
                  >
                </li>
              </ul>
            </li>
          </ul>
          <div>
            <span class="h4 fw-300 d-none" id="s02_login_username"
              >會員<span class="fw-300" id="s02_login_username"
                >xxx</span
              ></span
            >
            <button
              class="btn btn-outline-info"
              data-bs-toggle="modal"
              data-bs-target="#loginModal"
              id="s02_login_btn"
            >
              登入
            </button>
            <button
              class="btn btn-outline-warning"
              data-bs-toggle="modal"
              data-bs-target="#registerModal"
              id="s02_register_btn"
            >
              註冊
            </button>
            <button class="btn btn-danger d-none" id="s02_logout_btn">
              登出
            </button>
          </div>
        </div>
      </div>
    </nav>
  </section>

  <!-- loginModal -->
  <div
    class="modal fade"
    id="loginModal"
    tabindex="-1"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">會員登入</h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <div class="mb-3">
            <label for="username" class="form-label">帳號</label>
            <input
              type="text"
              name="loginModal_username"
              id="loginModal_username"
              class="form-control"
            />
          </div>
          <div class="mb-3">
            <label for="password" class="form-label">密碼</label>
            <input
              type="password"
              name="loginModal_password"
              id="loginModal_password"
              class="form-control"
            />
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            取消
          </button>
          <button
            type="button"
            class="btn btn-primary"
            id="loginModal_ok_btn"
          >
            確定
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- registerModal -->
  <div
    class="modal fade"
    id="registerModal"
    tabindex="-1"
    aria-labelledby="exampleModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">會員註冊</h1>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-6">
              <h3>會員守則</h3>
              <p>
               
              </p>
              <div class="form-check">
                <input
                  type="checkbox"
                  name="registerModal_chk"
                  id="registerModal_chk"
                  class="form-check-input is-invalid"
                />
                <label for="registerModal_chk" class="form-check-label"
                  >同意</label
                >
                <div class="valid-feedback">同意遵守規定</div>
                <div class="invalid-feedback">不同意遵守規定</div>
              </div>
            </div>
            <div class="col-6">
              <div class="mb-3">
                <label for="registerModal_username" class="form-label"
                  >帳號</label
                >
                <input
                  type="text"
                  name="registerModal_username"
                  id="registerModal_username"
                  class="form-control is-invalid"
                  placeholder="字數5-10"
                />
                <div class="valid-feedback">符合規定</div>
                <div class="invalid-feedback">不符合規定</div>
              </div>
              <div class="mb-3">
                <label for="registerModal_password" class="form-label"
                  >密碼</label
                >
                <input
                  type="password"
                  name="registerModal_password"
                  id="registerModal_password"
                  class="form-control is-invalid"
                  placeholder="字數8-12"
                />
                <div class="valid-feedback">符合規定</div>
                <div class="invalid-feedback">不符合規定</div>
              </div>
              <div class="mb-3">
                <label for="registerModal_re_password" class="form-label"
                  >確認密碼</label
                >
                <input
                  type="password"
                  name="registerModal_re_password"
                  id="registerModal_re_password"
                  class="form-control is-invalid"
                  placeholder="確認密碼"
                />
                <div class="valid-feedback">符合規定</div>
                <div class="invalid-feedback">不符合規定</div>
              </div>
              <div class="mb-3">
                <label for="registerModal_email" class="form-label"
                  >email</label
                >
                <input
                  type="email"
                  name="registerModal_email"
                  id="registerModal_email"
                  class="form-control is-invalid"
                  placeholder="字數3-15"
                />
                <div class="valid-feedback">符合規定</div>
                <div class="invalid-feedback">不符合規定</div>
              </div>
              <div class="my-3 text-center">
                <div class="col-12"></div>
                    <div class="card">
                        <div class="card-body">
                          <div class="form-check form-check-inline">
                            <input type="checkbox" id="interest_reading" class="form-check-input" name="check[]" value="閱讀">
                            <label for="interest_reading" class="form-check-label">閱讀</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input type="checkbox" id="interest_sports" class="form-check-input" name="check[]" value="打球">
                            <label for="interest_sports" class="form-check-label">打球</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input type="checkbox" id="interest_movies" class="form-check-input" name="check[]" value="電影">
                            <label for="interest_movies" class="form-check-label">電影</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input type="checkbox" id="interest_hiking" class="form-check-input" name="check[]" value="爬山">
                            <label for="interest_hiking" class="form-check-label">爬山</label>
                        </div>
                        <div class="form-check form-check-inline">
                            <input type="checkbox" id="interest_shopping" class="form-check-input" name="check[]" value="逛街">
                            <label for="interest_shopping" class="form-check-label">逛街</label>
                        </div>
                        </div>
                    </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            取消
          </button>
          <button
            type="button"
            class="btn btn-primary"
            id="registerModal_ok_btn"
          >
            確認
          </button>
        </div>
      </div>
    </div>
  </div>
<script src="js/bootstrap.bundle.min.js"></script>
<script src="js/jquery-3.7.1.min.js"></script>
<script src="https://unpkg.com/counterup2@2.0.2/dist/index.js"></script>
<script>
      var flag_username = false;
      var flag_password = false;
      var flag_re_password = false;
      var flag_email = false;
    
      $("#registerModal_username").bind("input propertychange", function () {
                if ($(this).val().length > 5 && $(this).val().length < 10) {
                    //符合前端規定
                    //傳遞至後端API確認帳號是否可以使用
                    var dataJSON = {};
                    dataJSON["username"] = $("#registerModal_username").val();
                    console.log(JSON.stringify(dataJSON));
                    //傳遞至後端API
                    $.ajax({
                        type: "POST",
                        url: "member-register-checkuni-api.php",
                        data: JSON.stringify(dataJSON),
                        dataType: "json",
                        success: showdata_checkuni,
                        error: function () {
                            alert("error-member-register-checkuni-api.php");
                        }
                    });
                } else {
                    //不符合規定
                    $(this).removeClass("is-valid");
                    $(this).addClass("is-invalid");
                    flag_username = false;
                }
            });

        //監聽password
        $("#registerModal_password").bind("input propertychange", function () {
          if ($(this).val().length > 8 && $(this).val().length < 13) {
            //符合規定
            $(this).removeClass("is-invalid");
            $(this).addClass("is-valid");
            flag_password = true;
          } else {
            //不符合規定
            $(this).removeClass("is-valid");
            $(this).addClass("is-invalid");
            flag_password = false;
          }
        });

        //監聽registerModal_re_password
        $("#registerModal_re_password").bind(
          "input propertychange",
          function () {
            if ($(this).val() == $("#registerModal_password").val()) {
              //符合規定
              $(this).removeClass("is-invalid");
              $(this).addClass("is-valid");
              flag_re_password = true;
            } else {
              //不符合規定
              $(this).removeClass("is-valid");
              $(this).addClass("is-invalid");
              flag_re_password = false;
            }
          }
        );

        //監聽email
        $("#registerModal_email").bind("input propertychange", function () {
          if ($(this).val().length > 2 && $(this).val().length < 16) {
            //符合規定
            $(this).removeClass("is-invalid");
            $(this).addClass("is-valid");
            flag_email = true;
          } else {
            //不符合規定
            $(this).removeClass("is-valid");
            $(this).addClass("is-invalid");
            flag_email = false;
          }
        });

        $("#registerModal_chk").change(function () {
          if ($(this).is(":checked")) {
            //打勾
            $(this).removeClass("is-invalid");
            $(this).addClass("is-valid");
            flag_chk = true;
          } else {
            //未打勾
            $(this).removeClass("is-valid");
            $(this).addClass("is-invalid");
            flag_chk = false;
          }
        });

        //註冊按鈕監聽
        $("#registerModal_ok_btn").click(function () {
          if (
            flag_username &&
            flag_password &&
            flag_re_password &&
            flag_email &&
            flag_chk
          ) {
            //傳遞註冊資料至後端API 執行註冊行為
            //{"username":"owner01", "password":"123456", "email": "owner@test.com"}
            var dataJSON = {};
            dataJSON["username"] = $("#registerModal_username").val();
            dataJSON["password"] = $("#registerModal_password").val();
            dataJSON["email"] = $("#registerModal_email").val();
            console.log(JSON.stringify(dataJSON));

            $.ajax({
              type: "POST",
              url: "member-register-test-api.php",
              data: JSON.stringify(dataJSON),
              dataType: "json",
              success: showdata_register,
              error: function () {
                alert("error-member-register-test-api.php");
              },
            });
          } else {
            // alert("欄位有錯請修正!");
            Swal.fire({
              title: "欄位有錯請修正!",
              showDenyButton: false,
              showCancelButton: false,
              confirmButtonText: "Save",
              denyButtonText: `Don't save`,
            }).then((result) => {
              /* Read more about isConfirmed, isDenied below */
              if (result.isConfirmed) {
                Swal.fire("Saved!", "", "success");
              } else if (result.isDenied) {
                Swal.fire("Changes are not saved", "", "info");
              }
            });
          }
        });

        //**********************************登入登出功能***********************************************
        //登入按鈕監聽
        $("#loginModal_ok_btn").click(function () {
          if (
            $("#loginModal_username").val() != "" &&
            $("#loginModal_password").val() != ""
          ) {
            //帳號密碼都有輸入
            //傳遞登入資料至後端API 執行登入行為
            //{"username":"owner01", "password":"123456"}
            var dataJSON = {};
            dataJSON["username"] = $("#loginModal_username").val();
            dataJSON["password"] = $("#loginModal_password").val();

            console.log(JSON.stringify(dataJSON));

            $.ajax({
              type: "POST",
              url: "member-login-api.php",
              data: JSON.stringify(dataJSON),
              dataType: "json",
              success: showdata_login,
              error: function () {
                alert("error-member-login-api.php");
              },
            });
          } else {
            //帳號密碼都有空白欄位
            alert("登入錯誤!");
          }
        });

        //登出按鈕監聽
        $("#s02_logout_btn").click(function () {
          setCookie("uid01", "", 7);
          location.href = "0730-spa.html";
        });
       //end fun

      function showdata_checkuni(data) {
        console.log(data);
        if (data.state) {
          $("#registerModal_username").removeClass("is-invalid");
          $("#registerModal_username").addClass("is-valid");
          flag_username = true;
        } else {
          $("#registerModal_username").removeClass("is-valid");
          $("#registerModal_username").addClass("is-invalid");
          flag_username = false;
        }
      }

      function showdata_register(data) {
        console.log(data);
        if (data.state) {
          alert(data.message);
          location.href = "0730-spa.html";
        } else {
          alert(data.message);
        }
      }
       
      function showdata_register(data){
            console.log(data);
            if(data.state){
                Swal.fire({
                        title: "是否註冊?",
                        showDenyButton: true,
                        showCancelButton: false,
                        confirmButtonText: "是",
                        denyButtonText: `否`
                }).then((result) => {
                        /* Read more about isConfirmed, isDenied below */
                        if (result.isConfirmed) {
                            Swal.fire("註冊成功", "", "success");
                            alert("已成功註冊");
                            location.href = "20240909-test1.html";
                        } else if (result.isDenied) {
                            Swal.fire("未完成註冊", "", "info");
                        }
                });
                // alert(data.message);
                
            }else{
                alert(data.message);
            }
        }

</script>

 </body>
 </html>
 
 